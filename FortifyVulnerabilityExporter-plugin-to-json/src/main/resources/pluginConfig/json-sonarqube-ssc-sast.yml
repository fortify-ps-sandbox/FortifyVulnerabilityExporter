---
spring.config.activate.on-loader-plugin: ssc

json.sonarqube.sast.filter.expr: vuln.engineType=='SCA'
json.sonarqube.sast.format:
  fields:
    issues: $[vulnerabilityMappers.issue.get()]
  vulnerabilityMappers.issue.fields:
    engineId: FortifySCA
    ruleId: $[vuln.issueName]
    severity: $[{'Critical':'CRITICAL','High':'MAJOR','Medium':'MINOR','Low':'INFO'}.get(vuln.friority)]
    type: VULNERABILITY
    primaryLocation:
      message: $[vuln.issueName] - $[vuln.deepLink]
      filePath: ${json.sonarqube.sast.filePathPrefix}$[vuln.fullFileName]
      textRange:
        startLine: $[vuln.lineNumber==0?1:vuln.lineNumber]
    # effortMinutes:
    # secondaryLocations:
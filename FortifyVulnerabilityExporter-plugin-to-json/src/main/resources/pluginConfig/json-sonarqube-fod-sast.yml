---
spring.config.activate.on-loader-plugin: fod

json.sonarqube.sast.filter.expr: vuln.scantype=='Static'
json.sonarqube.sast.format:
  fields:
    issues: $[vulnerabilityMappers.issue.get()]
  vulnerabilityMappers.issue.fields:
    engineId: FortifyOnDemand
    ruleId: $[vuln.category]
    severity: $[{'Critical':'CRITICAL','High':'MAJOR','Medium':'MINOR','Low':'INFO'}.get(vuln.severityString)]
    type: VULNERABILITY
    primaryLocation:
      message: $[vuln.category] - $[vuln.deepLink]
      filePath: ${json.sonarqube.sast.filePathPrefix}$[vuln.primaryLocationFull]
      textRange:
        startLine: $[vuln.lineNumber==0?1:vuln.lineNumber]
    # effortMinutes:
    # secondaryLocations:
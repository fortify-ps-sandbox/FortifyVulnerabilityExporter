---
spring.config.activate.on-loader-plugin: fod

json.awshub.sast.filter.expr: vuln.scantype=='Static'
json.awshub.sast.format:
  fields:
    issues: $[vulnerabilityMappers.issue.get()]
  vulnerabilityMappers.issue.fields:
    SchemaVersion: 2018-10-08
    Id: $[vuln.releaseId]-$[vuln.id]
    ProductArn: '--'
    GeneratorId: '--'
    ProductName: 'Fortify SAST'
    CompanyName: OpenText
    Types: "[ 'Software and Configuration Checks/Vulnerabilities/CVE' ]"
    CreatedAt: $[#formatDateTimewithZoneIdAsUTC("yyyy-MM-dd'T'HH:mm:ss.SSSSSS'Z'", release.staticScanDate?:'1970-01-01T00:00:00', release.serverZoneId)]
    UpdatedAt: $[#formatDateTimewithZoneIdAsUTC("yyyy-MM-dd'T'HH:mm:ss.SSSSSS'Z'", release.staticScanSummary?.completedDateTime?:'1970-01-01T00:00:00', release.serverZoneId)]
    Severity:
        Original: $[vuln.severityString]
        Normalized: $[{Critical:10.0,High:8.9,Medium:6.9,Low:3.9}.get(vuln.severityString)+'']
    Title: $[vuln.category]
    Description: $[#abbreviate(#htmlToText(vuln.all_data.details.summary).replaceAll("&nbsp;", " "),510)]
    Remediation:
        Recommendation:
            Text: $[#abbreviate(#htmlToText(vuln.all_data.recommendations?.recommendations).replaceAll("&nbsp;", " "),510)]
            Url: $[vuln.deepLink]
    ProductFields:
        Product Name: 'Fortify SAST'
    Resources:
        Type: Application
        Id: $[vuln.releaseId]-$[vuln.id]
        Partition: aws
        Region: '--'
        details:
            Other:
                APPLICATION: '$[vuln.releaseId]'
                APPLICATION NAME: $[vuln.release.applicationName]
                APPLICATION VERSION: $[vuln.release.releaseName]
                PRIMARY LOCATION: $[vuln.primaryLocationFull]
                LINE NUMBER: '$[vuln.lineNumber==0?1:vuln.lineNumber]'
                INSTANCE ID: "$[vuln.instanceId]"
    RecordState: ACTIVE
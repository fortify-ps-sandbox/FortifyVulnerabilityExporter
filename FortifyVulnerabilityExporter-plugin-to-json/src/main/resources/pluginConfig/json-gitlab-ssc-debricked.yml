---
spring.config.activate.on-loader-plugin: ssc

json.gitlab.debricked.filter.expr: vuln.engineType=='DEBRICKED'
json.gitlab.debricked.format:
  fields:
    schema: https://gitlab.com/gitlab-org/security-products/security-report-schemas/-/raw/v15.0.0/dist/dependency-scanning-report-format.json
    version: 15.0.0
    scan:
      start_time: $[#formatDateTime("yyyy-MM-dd'T'HH:mm:ss", applicationVersion.currentDebrickedScan?.uploadDate?:'1970-01-01T00:00:00')]
      end_time: $[#formatDateTime("yyyy-MM-dd'T'HH:mm:ss", applicationVersion.currentDebrickedScan?.uploadDate?:'1970-01-01T00:00:00')]
      status: success
      type: dependency_scanning
      analyzer:
        id: fortify-debricked
        name: Fortify/Debricked
        url: https://www.microfocus.com/en-us/products/application-security-testing/overview
        version: Debricked Fortify Parser Plugin $[applicationVersion.currentDebrickedScan?.engineVersion?:'version unknown']
        vendor:
          name: Fortify+Debricked
      scanner:
        id: fortify-debricked
        name: Fortify/Debricked
        url: https://www.microfocus.com/en-us/products/application-security-testing/overview
        version: Debricked Fortify Parser Plugin $[applicationVersion.currentDebrickedScan?.engineVersion?:'version unknown']
        vendor: 
          name: Fortify+Debricked
    dependency_files: $[{}]
    vulnerabilities: $[vulnerabilityMappers.vulnerability.get()]
  vulnerabilityMappers.vulnerability.fields:
    id: $[vuln.issueInstanceId]
    category: dependency_scanning
    name: $[vuln.issueName]
    message: $[vuln.issueName]
    description: $[#abbreviate(#htmlToText(vuln.details?.brief), 15000)]
    cve: $[vuln.details?.customAttributes?.externalId]
    severity: $[vuln.friority]
    confidence: $[(vuln.friority matches "(Critical|Medium)") ? "High":"Low" ]
    scanner:
      id: fortify-debricked
      name: Fortify/Debricked
    identifiers:
      - name:  "Instance id: $[vuln.issueInstanceId]"
        type:  issueInstanceId
        value: $[vuln.issueInstanceId]
        url:   $[vuln.deepLink]
    links:
      - name: Additional issue details, including analysis trace, in Software Security Center
        url:  $[vuln.deepLink]
      - name: CWE URL
        url:  $[vuln.details?.customAttributes?.externalUrl]
    location:
      file:           $[vuln.fullFileName]
      dependency:
        package:
          name:  $[vuln.details?.customAttributes?.componentName]
        version: $[vuln.details?.customAttributes?.componentVersion]
        
    
    
    
    
    
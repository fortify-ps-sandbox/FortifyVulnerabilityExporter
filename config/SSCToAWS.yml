# See FortifyVulnerabilityExporter documentation for SSC connection settings and application version selection

export:
  from: ssc
  to: json.awshub.sast

ssc:
  version:
    embed:                           # Load static and dynamic scan summaries if available
      - subEntity: currentStaticScan
        onError: LOG_INFO
      - propertyName: issueCountsSCA
        subEntity: issueGroups
        params:
          filter: ISSUE[11111111-1111-1111-1111-111111111151]:SCA
          groupingtype: 11111111-1111-1111-1111-111111111150
      - propertyName: issueCounts
        subEntity: issueGroups
        params:
          groupingtype: 11111111-1111-1111-1111-111111111150        
  vulnerability:
    filterParam: ISSUE[11111111-1111-1111-1111-111111111151]:SCA   # Have SSC return only SCA issues
    embed:                                                         # Also load details as required for GitHub output
      - subEntity: details     

export.dir: ${CI_PROJECT_DIR:${export.default.dir}} # Unless overridden, use CI_PROJECT_DIR if defined, otherwise default export dir
json.awshub.sast.output:
  stdout: true                       # Useful for debugging, disable for optimal performance
  pretty: true                       # Useful for debugging, disable for optimal performance
  file:   ${export.dir}/awshub-fortify-sast.json
